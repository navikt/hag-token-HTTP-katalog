meta {
  name: sykmelding
  type: http
  seq: 9
}

get {
  url: https://sykepenger-im-lps-api.ekstern.dev.nav.no/v1/sykmelding/{{id}}
  body: none
  auth: bearer
}

auth:bearer {
  token: 
}

vars:pre-request {
  scopes: nav:helse/im.read
  orgnr: 810007842
  id: bbaa6bcb-cdff-4b85-8e43-ed49baaaeb07
}

script:pre-request {
  const http = require('axios');
  const responseSystembruker = await http.post(
    'https://hag-lps-api-client.ekstern.dev.nav.no/systembruker', 
    'orgnr=' + bru.getRequestVar("orgnr") + '&' + 'scopes=' + bru.getRequestVar("scopes")
  )
  
  const token = responseSystembruker.data.tokenResponse.access_token;
  req.setHeader('Authorization', "Bearer "+ token);
}
